<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>O Guardião do Primeiro Canto</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#d4af37">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icone-galo.png">

<style>
body{
background:linear-gradient(180deg,#d4af37,#b8962e);
color:#1a1a1a;
font-family:Arial;
padding:20px;
text-align:center;
margin:0;
}

.titulo{
display:flex;
align-items:center;
justify-content:center;
gap:10px;
}

.icon-title{width:42px}

.perfil{
width:120px;
margin:15px auto;
display:block;
}

button{
width:100%;
padding:16px;
margin:7px 0;
background:#111;
color:#fff;
border:none;
font-size:17px;
border-radius:12px;
cursor:pointer;
}

.login{
max-width:320px;
margin:80px auto;
background:#00000022;
padding:20px;
border-radius:15px;
}

input{
width:100%;
padding:12px;
margin:6px 0;
border-radius:8px;
border:none;
font-size:16px;
}
</style>
</head>

<body>
<div id="app"></div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

"use strict";

const App = {

usuario:null,
galo:null,

// ================= INIT =================
init(){
this.usuario = localStorage.getItem("usuarioAtual");
this.usuario ? this.carregarJogo() : this.telaLogin();
},

// ================= LOGIN =================
telaLogin(){
app.innerHTML=`
<div class="login">
<h2>Login do Guardião</h2>
<input id="user" placeholder="Usuário">
<input id="pass" type="password" placeholder="Senha">
<button id="btnCriar">Criar Conta</button>
<button id="btnEntrar">Entrar</button>
</div>
`;

btnCriar.onclick=()=>this.criarConta();
btnEntrar.onclick=()=>this.login();
},

criarConta(){
let u=user.value.trim();
let p=pass.value.trim();
if(!u||!p)return alert("Preencha tudo");

if(localStorage.getItem("conta_"+u))
return alert("Usuário já existe");

localStorage.setItem("conta_"+u,JSON.stringify({
senha:p,
dados:null
}));

alert("Conta criada!");
},

login(){
let u=user.value.trim();
let p=pass.value.trim();

let conta=JSON.parse(localStorage.getItem("conta_"+u));
if(!conta || conta.senha!==p)
return alert("Login inválido");

localStorage.setItem("usuarioAtual",u);
location.reload();
},

logout(){
localStorage.removeItem("usuarioAtual");
location.reload();
},

// ================= JOGO =================
carregarJogo(){
app.innerHTML=`
<h1 class="titulo">
<img src="icone-galo.png" class="icon-title">
O Guardião do Primeiro Canto
</h1>

<img id="perfil" class="perfil">
<h2 id="nivel"></h2>
<div id="idade"></div>
<div id="personalidade"></div>
<div id="stats"></div>

<button data-acao="alimentar">Alimentar</button>
<button data-acao="cuidar">Cuidar do espaço</button>
<button data-acao="movimento">Movimento leve</button>
<button data-acao="contato">Contato calmo</button>
<button data-acao="observar">Observação silenciosa</button>

<button id="alterar">Alterar data nascimento</button>
<button id="logout">Trocar conta</button>
`;

document.querySelectorAll("[data-acao]").forEach(btn=>{
btn.onclick=()=>this.acao(btn.dataset.acao);
});

alterar.onclick=()=>this.alterarNascimento();
logout.onclick=()=>this.logout();

this.iniciarSistema();
},

iniciarSistema(){

let conta = JSON.parse(localStorage.getItem("conta_"+this.usuario));

this.galo = conta.dados || {
vitalidade:20,
forca:10,
disciplina:10,
confianca:10,
instinto:5,
nascimento:null
};

if(!this.galo.nascimento){
let d=prompt("Data nascimento (AAAA-MM-DD)","2026-01-28");
let t = Date.parse(d+"T00:00:00");
this.galo.nascimento = isNaN(t)?Date.now():t;
this.salvar();
}

this.atualizar();
},

salvar(){
let conta = JSON.parse(localStorage.getItem("conta_"+this.usuario));
conta.dados = this.galo;
localStorage.setItem("conta_"+this.usuario,JSON.stringify(conta));
},

alterarNascimento(){
let d=prompt("Nova data (AAAA-MM-DD)");
if(!d)return;
let t = Date.parse(d+"T00:00:00");
if(isNaN(t))return alert("Data inválida");
this.galo.nascimento=t;
this.salvar();
this.atualizar();
},

// ================= LÓGICA =================
idade(){
let diff=Date.now()-this.galo.nascimento;
if(diff<0)diff=0;
return Math.floor(diff/86400000);
},

fase(d){
if(d<7)return[1,"Recém-Nascido"];
if(d<30)return[2,"Filhote"];
if(d<60)return[3,"Jovem"];
if(d<120)return[4,"Adolescente"];
if(d<240)return[5,"Quase Adulto"];
return[6,"Adulto"];
},

nivel(){
let g=this.galo;
return Math.floor((g.vitalidade+g.forca+g.disciplina+g.confianca+g.instinto)/5);
},

personalidade(){
let n=this.nivel();
if(n<30)return"Instinto Selvagem";
if(n<50)return"Espírito em Formação";
if(n<70)return"Aprendiz Vigilante";
if(n<90)return"Guardião Jovem";
return"Guardião Supremo";
},

acao(tipo){

if(tipo==="alimentar"){this.galo.vitalidade+=5;this.galo.forca+=2;}
if(tipo==="cuidar"){this.galo.vitalidade+=3;this.galo.confianca+=2;}
if(tipo==="movimento"){this.galo.forca+=4;this.galo.instinto+=2;}
if(tipo==="contato"){this.galo.disciplina+=4;this.galo.confianca+=3;}
if(tipo==="observar"){this.galo.disciplina+=3;this.galo.instinto+=3;}

for(let k in this.galo)
if(typeof this.galo[k]==="number" && this.galo[k]>999)
this.galo[k]=999;

this.salvar();
this.atualizar();
},

// ================= RENDER =================
atualizar(){

let dias=this.idade();
let fase=this.fase(dias);

perfil.src=`fase-${fase[0]}.png`;
nivel.innerText=`Nível ${this.nivel()} • ${fase[1]}`;
idade.innerText=`Idade: ${dias} dias`;
personalidade.innerText=`Personalidade: ${this.personalidade()}`;

stats.innerHTML=`
Vitalidade: ${this.galo.vitalidade}<br>
Força: ${this.galo.forca}<br>
Disciplina: ${this.galo.disciplina}<br>
Confiança: ${this.galo.confianca}<br>
Instinto: ${this.galo.instinto}
`;
}

};

App.init();

});
</script>
</body>
</html>
