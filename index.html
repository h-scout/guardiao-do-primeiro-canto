<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>O Guardião do Primeiro Canto</title>

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#d4af37">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="icone-galo.png">

<style>
body{
background:linear-gradient(180deg,#d4af37,#b8962e);
color:#1a1a1a;
font-family:Arial;
padding:20px;
text-align:center;
}

.titulo{
display:flex;
align-items:center;
justify-content:center;
gap:10px;
}

.icon-title{width:42px}

.perfil{
width:120px;
margin:15px auto;
display:block;
}

.status{
margin:14px 0;
text-align:left;
}

.linha{
display:flex;
align-items:center;
gap:8px;
margin-bottom:4px;
}

.attr{width:26px}

.bar{
background:rgba(0,0,0,0.25);
height:20px;
border-radius:10px;
overflow:hidden;
}

.fill{height:100%}

.vitalidade{background:#e53935}
.forca{background:#6d4c41}
.disciplina{background:#1e88e5}
.confianca{background:#43a047}
.instinto{background:#fdd835}

button{
width:100%;
padding:16px;
margin:7px 0;
background:#111;
color:#fff;
border:none;
font-size:17px;
border-radius:12px;
display:flex;
align-items:center;
gap:10px;
justify-content:center;
}

.btnicon{width:34px}

.login{
max-width:300px;
margin:80px auto;
background:#00000022;
padding:20px;
border-radius:15px;
}

input{
width:100%;
padding:12px;
margin:6px 0;
border-radius:8px;
border:none;
font-size:16px;
}
</style>
</head>

<body>

<div id="app"></div>

<script>

// ================= LOGIN SYSTEM =================

let usuarioAtual = localStorage.getItem("usuarioAtual");

if(!usuarioAtual){
document.getElementById("app").innerHTML=`
<div class="login">
<h2>Login do Guardião</h2>
<input id="user" placeholder="Usuário">
<input id="pass" type="password" placeholder="Senha">
<button onclick="criarConta()">Criar Conta</button>
<button onclick="login()">Entrar</button>
</div>
`;
}else{
carregarJogo();
}

function criarConta(){

let u=user.value.trim();
let p=pass.value.trim();

if(!u||!p)return alert("Preencha tudo");

if(localStorage.getItem("conta_"+u))
return alert("Usuário já existe");

localStorage.setItem("conta_"+u,JSON.stringify({
senha:p,
dados:null
}));

alert("Conta criada!");
}

function login(){

let u=user.value.trim();
let p=pass.value.trim();

let conta=JSON.parse(localStorage.getItem("conta_"+u));

if(!conta || conta.senha!==p)
return alert("Login inválido");

localStorage.setItem("usuarioAtual",u);
location.reload();
}

function logout(){
localStorage.removeItem("usuarioAtual");
location.reload();
}

// ================= JOGO =================

function carregarJogo(){

document.getElementById("app").innerHTML=`

<h1 class="titulo">
<img src="icone-galo.png" class="icon-title">
O Guardião do Primeiro Canto
</h1>

<img id="perfil" class="perfil">

<h2 id="nivel"></h2>
<div id="idade"></div>
<div id="personalidade"></div>

<div id="stats"></div>

<button onclick="acao('alimentar')"><img class="btnicon" src="botao-alimentar.png"> Alimentar</button>
<button onclick="acao('cuidar')"><img class="btnicon" src="botao-cuidar.png"> Cuidar do espaço</button>
<button onclick="acao('movimento')"><img class="btnicon" src="botao-movimento.png"> Movimento leve</button>
<button onclick="acao('contato')"><img class="btnicon" src="botao-contato.png"> Contato calmo</button>
<button onclick="acao('observar')"><img class="btnicon" src="botao-observar.png"> Observação silenciosa</button>

<button onclick="alterarNascimento()">Alterar data nascimento</button>
<button onclick="logout()">Trocar conta</button>
`;

iniciarSistema();
}

// ================= DADOS =================

let galo;
let dadosConta;

function iniciarSistema(){

dadosConta = JSON.parse(localStorage.getItem("conta_"+usuarioAtual));

galo = dadosConta.dados || {
vitalidade:20,
forca:10,
disciplina:10,
confianca:10,
instinto:5,
nascimento:null
};

// NASCIMENTO
if(!galo.nascimento){

let d=prompt("Data nascimento (AAAA-MM-DD)","2026-01-28");

let t = Date.parse(d+"T00:00:00");

galo.nascimento = isNaN(t) ? Date.now() : t;

salvar();
}

atualizar();
}

// SALVAR
function salvar(){
dadosConta.dados = galo;
localStorage.setItem("conta_"+usuarioAtual,JSON.stringify(dadosConta));
}

// ALTERAR DATA
function alterarNascimento(){

let d=prompt("Nova data (AAAA-MM-DD)");
if(!d)return;

let t = Date.parse(d+"T00:00:00");

if(isNaN(t)) return alert("Data inválida");

galo.nascimento=t;
salvar();
atualizar();
}

// IDADE REAL
function idade(){

let diff = Date.now()-galo.nascimento;
if(diff<0)diff=0;

let d=Math.floor(diff/86400000);
let h=Math.floor((diff%86400000)/3600000);
let m=Math.floor((diff%3600000)/60000);

return {d,h,m};
}

// FASE REAL
function faseReal(d){
if(d<7)return[1,"Recém-Nascido"];
if(d<30)return[2,"Filhote"];
if(d<60)return[3,"Jovem"];
if(d<120)return[4,"Adolescente"];
if(d<240)return[5,"Quase Adulto"];
return[6,"Adulto"];
}

// PERSONALIDADE
function personalidade(){

let m=(galo.vitalidade+galo.forca+galo.disciplina+galo.confianca+galo.instinto)/5;

if(m<30)return"Instinto Selvagem";
if(m<50)return"Espírito em Formação";
if(m<70)return"Aprendiz Vigilante";
if(m<90)return"Guardião Jovem";
return"Guardião Supremo";
}

// NÍVEL
function nivel(){
return Math.floor((galo.vitalidade+galo.forca+galo.disciplina+galo.confianca+galo.instinto)/5);
}

// SOM
function tocar(n){
let a=new Audio(n);
a.volume=0.35;
a.play();
}

// AÇÕES
function acao(t){

if(t==="alimentar"){galo.vitalidade+=5;galo.forca+=2;tocar("click-alimentar.m4a");}
if(t==="cuidar"){galo.vitalidade+=3;galo.confianca+=2;tocar("click-cuidar.m4a");}
if(t==="movimento"){galo.forca+=4;galo.instinto+=2;tocar("click-movimento.m4a");}
if(t==="contato"){galo.disciplina+=4;galo.confianca+=3;tocar("click-contato.m4a");}
if(t==="observar"){galo.disciplina+=3;galo.instinto+=3;tocar("click-observar.m4a");}

for(let k in galo) if(typeof galo[k]==="number" && galo[k]>999) galo[k]=999;

salvar();
atualizar();
}

// RENDER
function atualizar(){

let id=idade();
let fase=faseReal(id.d);

perfil.src=`fase-${fase[0]}.png`;

nivel.innerText=`Nível ${nivel()} • ${fase[1]}`;
idade.innerText=`Idade: ${id.d}d ${id.h}h ${id.m}m`;
personalidade.innerText=`Personalidade: ${personalidade()}`;

stats.innerHTML=`

<div class="status">
<div class="linha"><img class="attr" src="vitalidade.png"> ${galo.vitalidade}</div>
<div class="bar"><div class="fill vitalidade" style="width:${galo.vitalidade}%"></div></div>
</div>

<div class="status">
<div class="linha"><img class="attr" src="forca.png"> ${galo.forca}</div>
<div class="bar"><div class="fill forca" style="width:${galo.forca}%"></div></div>
</div>

<div class="status">
<div class="linha"><img class="attr" src="disciplina.png"> ${galo.disciplina}</div>
<div class="bar"><div class="fill disciplina" style="width:${galo.disciplina}%"></div></div>
</div>

<div class="status">
<div class="linha"><img class="attr" src="confianca.png"> ${galo.confianca}</div>
<div class="bar"><div class="fill confianca" style="width:${galo.confianca}%"></div></div>
</div>

<div class="status">
<div class="linha"><img class="attr" src="instinto.png"> ${galo.instinto}</div>
<div class="bar"><div class="fill instinto" style="width:${galo.instinto}%"></div></div>
</div>
`;
}

</script>
</body>
</html>
